# Robogen 调研报告

## 1. 概述

**Robogen 是什么?**

RoboGen是一个利用最新基础和生成模型进展的机器人代理。它不同于直接将这些模型应用于产生策略或低级动作的方法，RoboGen采用了一种生成方案，使用这些模型自动生成多样化的任务、场景和训练指导，从而在最少的人类监督下扩展机器人技能学习。

**Robogen想解决什么问题?**

1. **模拟环境构建的劳动强度：**
   - 传统的模拟环境构建需要大量的人力工作，包括设计任务、生成相关资产、布局场景和配置训练指导（如奖励函数）。这个过程既耗时又费力。
2. **任务和环境的多样性：**
   - 在模拟环境中生成多样化和实际的任务对于机器人学习来说是至关重要的，但手动创建这些任务和环境非常有限，难以覆盖广泛的技能和场景。
3. **模拟到现实世界的应用（Sim-to-Real Gap）：**
   - 即使在模拟环境中表现良好的策略和技能，转移到现实世界中可能会遇到挑战，因为现实世界的复杂性和不确定性更高。
4. **数据收集和计算资源的限制：**
   - 现实世界中的探索和数据收集可能需要大量的计算资源和时间，而且可能受到物理硬件投资的限制。
5. **自动化和规模化的机器人技能学习：**
   - 现有的机器人学习流程很大程度上依赖于手动设计和监督，这限制了技能学习的规模化和自动化。

**Robogen 能干什么?**

- **任务生成：** RoboGen能够自我提出有趣的任务和技能来发展。

- **场景构建：** 根据提出的任务，生成模拟环境，包括适当的资产和空间配置。
- **任务分解与学习策略选择：** 将任务分解为子任务，并选择最佳的学习方法（强化学习、运动规划或轨迹优化）。
- **训练指导生成：** 生成所需的训练指导，如奖励函数。
- **技能学习：** 通过生成的政策来获取提出的技能。
- **无限数据流：** 能够反复查询，产生与多样化任务和环境相关的无尽技能演示流。

**Robogen是怎么做到的?**

- **自我引导的循环：** RoboGen遵循一个自我引导的“提议-生成-学习”循环。
- **任务提议：** 通过大型语言模型（LLM）基于机器人类型和随机采样的对象生成任务提议。
- **场景生成：** 根据任务需求，检索和验证相关资产，确定资产大小和初始配置，以及场景配置。
- **训练指导生成：** 通过LLM规划和分解任务，选择合适的算法，并为强化学习子任务生成奖励函数。
- **技能学习：** 结合强化学习、基于梯度的轨迹优化和动作原语与运动规划等技术，学习完成每个子任务的技能。
- **生成性管道：** RoboGen的整个流程是完全生成性的，可以不断产生新的技能和任务。

## 2. 相关工作

在机器人技能学习领域，相关工作主要集中在模拟环境的开发和利用，这些环境提供了丰富的数据和低成本的实验平台。物理基础模拟平台如刚体模拟器和可变形物体模拟器已被广泛用于学习复杂技能，如物体操控和流体交互。此外，为了扩展模拟环境和任务的多样性，研究者们探索了程序生成和任务与运动规划（TAMP）的方法，尽管这些方法通常受限于手动定义的规则。随着基础和生成模型在图像、语言等领域的进展，这些模型也被用于机器人研究，包括代码生成、数据增强和子任务规划。特别是，大型语言模型（LLMs）被用于奖励函数生成、子任务和轨迹生成，以及直接编写代码脚本以操纵物体。RoboGen的提出，通过利用这些先进的模型自动生成任务、场景和训练指导，旨在减少人为监督，实现机器人技能学习的规模化和自动化，与现有工作相比，它通过一个完全生成的流程，能够持续产生多样化的技能演示，推动了自动化大规模机器人技能训练和演示收集的边界。

## 3. 实现细节

![1.png](attachment%2F1.png)

主要有4个模块 **1. 任务提出, 2. 场景生成, 3. 监督训练, 4. 技能学习**

### 3.1 任务提出

RoboGen的任务提议阶段通过初始化系统开始，指定一个机器人类型和一个从预定义池中随机抽样的对象。这些信息被用作输入，以启动一个大型语言模型（LLM），来生成与机器人能力和对象功能相匹配的任务提案。此外，系统还支持基于示例的初始化，通过提供一组预定义任务的示例来引导任务的生成。生成的任务包括任务名称、自然语言描述、所需附加对象以及与任务相关的关节和链接，确保任务在语义上和功能上都是有意义的。

1. 抽样对象的类别。
2. 从其URDF文件中派生的关节树（articulation tree）。
3. 对象关节中链接的语义注释，例如，哪个链接对应于抽样微波炉的门。

### 3.2 场景生成

在RoboGen系统中，生成一个与任务提案相对应的场景需要获取四个不同组件的信息，通过查询GPT-4来获取额外的语义相关对象，以增加场景的复杂性和多样性。以下是4个不同组件的信息

1. 相关资产

- **任务相关资产列表**：在任务提议阶段，已经确定了执行任务所需的相关资产列表。为了增加场景的复杂性和多样性，同时模拟现实世界中的对象分布，系统会查询GPT-4来返回与任务语义相关的其他对象的查询（名称和描述）。
- **数据库检索**：使用Objaverse等对象网格数据库，根据资产查询名称检索匹配的对象。Objaverse包含超过80万个对象资产（3D网格、纹理等）

2. 资产尺寸

- **尺寸合理化**：从Objaverse等数据库检索或生成的资产通常不具备物理上合理的尺寸。系统会查询GPT-4来生成资产的尺寸，确保尺寸与现实世界中的对象尺寸相匹配，并且对象之间的相对尺寸允许合理地完成任务。

3. 初始化资产配置

- **关节对象的初始状态**：对于某些任务，关节对象需要被初始化为有效的状态，以便机器人学习技能。例如，如果任务是“关闭窗户”，窗户需要被初始化为打开状态；对于“打开门”的任务，门需要被初始化为关闭状态。
- **关节角度设置**：系统再次查询GPT-4来设置这些关节对象的初始配置，具体指定为关节角度。

4. 初始场景配置

- **空间配置**：确定每个资产的位置和与任务描述相关的特殊空间关系对于生成合理的环境和有效的技能学习至关重要。例如，对于“从保险箱中取文件”的任务，文件需要被初始化在保险箱内部；对于“从砧板上移除刀”的任务，刀需要被初始化放在砧板上。
- **避免碰撞**：RoboGen指导GPT-4以避免碰撞的方式放置对象，确保场景中的对象配置合理。

### 3.3 监督训练

训练监督生成阶段涉及将复杂任务分解为短期子任务，并为每个子任务选择合适的学习算法，强化学习、基于梯度的轨迹优化或动作原语与运动规划。对于需要强化学习的子任务，RoboGen提示GPT-4编写相应的奖励函数，通过这些步骤，RoboGen能够为机器人提供执行任务所需的详细指导和监督，从而在模拟环境中自动学习和掌握各种技能。

### 3.4 技能学习

在技能学习阶段，RoboGen利用从任务提案、场景生成和训练监督生成阶段获得的所有信息来构建模拟环境中的场景。对于涉及多个子任务的长期任务，RoboGen采用简单的顺序学习方案，每个子任务运行多次，并使用获得最高奖励的最终状态作为下一个子任务的初始状态。系统结合了强化学习、基于梯度的轨迹优化和动作原语与运动规划等技术，根据任务的具体情况动态选择最合适的学习算法，以实现有效的技能学习。

## 4. 实验

RoboGen的实验部分旨在回答几个关键问题，涉及任务多样性、场景有效性、训练监督有效性、技能学习性能以及整个系统的性能。以下是实验的具体内容和得出的结论：

### 4.1 实验设置

- **系统通用性**：RoboGen是一个通用系统，与特定的模拟平台无关。但由于考虑了从刚体动力学到软体模拟的各种任务类别，以及需要可微分模拟平台的梯度基础轨迹优化，实验使用了Genesis模拟平台。
- **技能学习算法**：使用SAC（Soft Actor-Critic）作为强化学习算法，对于每个子任务训练1M环境步。

### 4.2 评估指标和基线

- **任务多样性**：通过计算生成任务描述的SelfBLEU和嵌入相似度（使用ImageNet预训练的ViT和CLIP模型）来量化任务的语义和视觉多样性。
- **场景有效性**：通过BLIP-2分数和人类评估来验证检索对象是否符合任务要求。
- **训练监督有效性**：通过人类验证和视频展示学习的技能来评估生成的任务分解和训练监督是否合理。
- **技能学习性能**：通过技能学习成功率来量化分析，成功率定义为成功学习技能的尝试次数与总尝试次数的比率。

### 4.3 结果

- **任务多样性**：RoboGen在语义和视觉多样性方面超过了先前手动制作的机器人技能学习基准和数据集。
- **场景有效性**：通过BLIP-2分数和人类评估，验证了RoboGen生成的场景与任务描述的一致性，以及场景配置和检索对象的正确性。
- **训练监督有效性**：展示了使用RoboGen生成的训练监督学习的技能，表明自动生成的训练监督能够有效地引导机器人学习有意义的技能。
- **技能学习**：RoboGen在69个基准任务上的平均成功率为0.774，表明在大多数情况下能够成功学习技能。
- **系统性能**：通过网站展示了100多个学习技能的视频，证明了RoboGen能够生成多样化的任务和技能演示。